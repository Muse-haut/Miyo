WELCOME_GIFS = [
  '[Yay !](https://tenor.com/nwjJy31nO7l.gif)',
  '[Super !](https://tenor.com/bOOeL.gif)',
  '[Ouais !](https://tenor.com/bpdyo.gif)',
  '[Incroyable !](https://tenor.com/cDMkOM91zdc.gif)',
  '[Hello !](https://media.giphy.com/media/f2eEmGGO6MaaG4hCHE/giphy.gif?cid=790b7611ktk51fecy8tq8g8wnh94ukxxpp50vz2gkp5w0qg2&ep=v1_gifs_search&rid=giphy.gif&ct=g)',
  "[Viens t'amuser avec nous !](https://tenor.com/bm9Xa.gif)",
  "[Salut !](https://tenor.com/bKY1N.gif)",
  "[Rejoint nos rangs !](https://tenor.com/dGmXXLPxIB3.gif)",
  "[YATAAAAAAA](https://tenor.com/lxOcXvTavpU.gif)",
  "[Let's dance !](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjhpNHFzeGpkcTFjN3ZpYThhdnoweHNiZXNiZTl5cjFpY3loeWx3dCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/iwsFHeFMtn3nNxSdP8/giphy.gif)",
  "[Coucou !](https://tenor.com/lPqSCzv1Vab.gif)",
  "[Crazy de baisé comme disent les jeunes !](https://tenor.com/bYZb2.gif)",
  "[My honest reaction :](https://tenor.com/qMaL64pTqow.gif)",
  "[Look and be amazed !](https://tenor.com/tmkzH2Dmimx.gif)",
  "[J'vais pouvoir encore plus yapper !](https://tenor.com/NL7v.gif)",
  "[LET'S GOOOOO](https://tenor.com/b0xL6.gif)",
  "[Eheh !](https://tenor.com/WJZSUfm6CT.gif)",
  "[T'as fais le bon choix bro !](https://tenor.com/bTZnm.gif)",
  "[Moi, Miyo, fait le serment que c'est une bonne personne !](https://tenor.com/bM6AVMfdZZi.gif)",
  "[HIIIIIIIII !!!!](https://tenor.com/v12LabRG0zu.gif)",
  "[Eh oui, j'te vois de loin !](https://tenor.com/iH74EEgzMvE.gif)",
  "[Un avenir radieux se présente à nous !](https://tenor.com/mX1oju0QV2b.gif)",
  "[Bienvenue !](https://tenor.com/iuy8xBOlRxS.gif)",
  "[HEYOOOOO](https://tenor.com/bZZVI.gif)",
  "[L'invitation a été prise en compte !](https://tenor.com/lwhjabJxnbu.gif)",
  "[Un membre en plus, un !](https://tenor.com/kCiRbFqdLmk.gif)",
  "[Welcome in the palace baby.](https://tenor.com/hOFPVAXMuCY.gif)",
  "[Dépêchez-vous de lui dire bienvenue enfin !](https://tenor.com/bbvZR.gif)",
  "[J'en suis ému.](https://tenor.com/v7ofWS0M329.gif)",
  "[Son flow est tellement énorme !](https://tenor.com/vOsc.gif)",
  "[Je t'invoques, nouveau membre !](https://tenor.com/bnwng.gif)",
  "[Bon choix !](https://tenor.com/GXmU.gif)",
  "[Fêtons celà !](https://tenor.com/bYGCg.gif)",
  "[Okkei !](https://tenor.com/bRtFG.gif)",
  "[Coucou !](https://tenor.com/b14qi.gif)",
  "[HAYYYYO !](https://tenor.com/bwtXM.gif)",
  "[POURQUOI T'ES PAS VENU PLUS TÔT ???](https://tenor.com/lpxOGwxcz1r.gif)",
  "[Nice !](https://tenor.com/bia9u.gif)",
  "[Let's goooo !](https://tenor.com/brGXr.gif)",
  "[Parfait !](https://tenor.com/ni6UjJBYBiF.gif)",
  "[Real footage of me on my way to welcome you](https://tenor.com/w4bN.gif)",
  "[Prends place ici !](https://tenor.com/bDGkM.gif)",
  "[BIENVENUE ! ÇA VA ? TU FAIS QUOI DE BEAU ? C'EST QUOI TES PASSIONS ?](https://tenor.com/b0gtP.gif)",
  "[Bienvenue parmis-nous !](https://tenor.com/bVJcM.gif)",
  "[Mais c'est super ça ! J'espère que tu y trouveras ta place !](https://tenor.com/bWYzp.gif)",
  "[Bienvenue !](https://tenor.com/gzz5k1lQP54.gif)",
  "[YAY !](https://tenor.com/btUTb.gif)",
  "[YAY !](https://tenor.com/uQNM6NTAzic.gif)",
  "[Ça n'atteindra pas ma grandeur, mais ça à le mérite d'être une bonne nouvelle.](https://tenor.com/bnQeh.gif)",
  "[Viens par là !](https://tenor.com/v8dGBu6DpwJ.gif)",
  "[Yo !](https://tenor.com/bXQ27.gif)",
  "[T'as un 06 ? T'es tellement bg en même temps](https://tenor.com/bXHK0.gif)",
  "[Meh, ta présence m'occupera au moins](https://tenor.com/ugCvuIS5pXJ.gif)",
  "[Dance de la victoire be like :](https://tenor.com/bXNGX.gif)",
  "[Real footage of me fainting when you joined :](https://tenor.com/bHwIj.gif)",
  "[Dépêchez-vous de lui dire bienvenue enfin !](https://tenor.com/blqM6.gif)",
  "[LET'S GOOOOO](https://tenor.com/7OTa.gif)",
  "[UN NOUVEAU ???](https://tenor.com/bPhDt.gif)",
  "[Coucou !](https://tenor.com/bpYmT.gif)",
  "[Moi, Miyo, détentrice de l’Œil Crépusculaire de la Vérité Ultime, élue par le Conseil Occulte de la Troisième Dimension Cachée, t’invoque ici-même, dans le royaume scellé par les sceaux runiques du Chaos Brillant !\nEn posant les pieds dans cette zone sanctifiée, tu as déclenché le Rituel d’Éveil des Âmes Égarées, et ton destin est désormais lié au mien par les chaînes invisibles du pacte sacré.\nPrends garde, voyageur stellaire, car cet endroit est un nexus interdimensionnel où les pensées prennent vie, où les emojis sont des familiers magiques, et où les règles sont écrites dans une langue que seuls les vrais éveillés peuvent lire.\nN’oublie pas : seul l’Œil de la Vérité peut discerner le bon du faux post, et seul le cœur pur peut survivre à la tempête des threads perdus.\nEngage-toi avec courage, commente avec bravoure, et surtout, protège ton âme des spoilers maudits !\nPar l’autorité du Grand Conseil Lunaire…\n**Bienvenue.**\nQue ton pouvoir caché se réveille… maintenant.](https://tenor.com/bLC2V.gif)",
  "[Moi, Miyo… non, Dark Flame Master, ancien héraut du Néant Flamboyant et gardien du Contrat Déchu des Neuf Cercles Silencieux, je me tiens devant toi.\nBien que j’aie scellé mes pouvoirs dans les abysses du quotidien, ce sanctuaire — ce forum — m’a rappelé… et j’ai répondu à l’appel.\nToi qui lis ces lignes, sache que tu as franchi le Voile des Mondes Simulés, et tu pénètres à présent dans un espace où les lois de la logique sont secondaires face à l’énergie du cœur.\nIci, les mots sont des incantations, les réactions des pactes, et chaque thread un fragment d’univers.\nEngage-toi avec honneur, et n’oublie jamais : même l’ombre la plus noire contient une lueur de flamme.\nAlors je t’accueille, voyageur interplanaire, au nom du Conseil Silencieux de la Lueur Oubliée…\nBienvenue.\nMais souviens-toi… le véritable pouvoir dort encore en toi.](https://tenor.com/bF16c.gif)"
]


WELCOME_MESSAGES = [
  "Hey {user}! Bienvenue sur {server} !",
  "Heyo tout le monde ! Accueillons {user} !",
  "Mais non ?! Un nouveau membre en plus ! Venez accueillir {user} !",
  "Les patates respirent ! Mais plus important, l'accueil de {user} !",
  "Regardez au loin ! Mais ça ne serait pas... Mais si ! C'est {user} ! Acceuillez-le chaleureusement !",
  "Préparez les canons à confettis, {user} est dans la place !",
  "Et un nouveau membre, un ! Bienvenue {user} !",
  "Tiens ? Tout comme moi une personne charmante est apparue, et il s'agit de {user} !",
  "Je tiens à vous informer que {user} est arrivé sur {server} !",
  "Mais non ?! Le navet à un cours de 1000 clochettes unités ?! Mince, j'ai trop joué à Animal Crossing... Veuillez acceuillir {user} !",
  "Bien le bonjour {user} ! Prends place dans cette magnifique contrée qu'est {server}",
  "On dit souvent aux enfant que les personnes naissent dans des choux, pourtant je promet que {user} à juste suivis un lien! Quel pouvoir !",
  "{user} à rejoint avant Half Life 3 ! C'est fou quand-même ?!",
  "Quoi ?! Elsa et Michou sont plus en couple ? Mouais nan pas intéressant, contrairement à notre nouveau membre : {user} !",
  "Ohhhh, allez une dernière Maman ! Oups mauvais chat... REGARDEZ LÀ BAS, C'EST {user}\n**Part en courant**",
  "Tiens ? Un nouveau sujet est apparus dans la cour. Quel est ton nom ? {user} ? Bienvenue dans {server} !",
  "Oh ! {user} ! Bienvenue dans {server}",
  "Bienvenue {user} !",
  "Un nouveau membre est apparu, et il s'agit de {user} !",
  "J'utilise la loi 49 alinéa 3 pour vous obliger à dire bienvenue à {user} !",
  "Ma maman m'a dit de pas parler aux inconnus, mais vu que tu es désormais dans le serveur, tu n'es plus un inconnu {user} !",
  "{user} ! Enfin ! Je m'impatientais de ta venue sur {server}!",
  "MREKK À ENCORE DÉFIÉ LA LIMITE HUMAINE ??? Mouais, normal quoi... Oh mais attends... {user} À REJOINT LE SERVEUR ??? FÊTONS ÇA !",
  "Z'AVEZ VU MON NOUVEAU LEGO ? Nan on s'en fout tous, c'est pas important comparé à... PAF, R'GARDEZ L'NOUVEAU MEMBRE ! C'est {user} !",
  "{user} n'a jamais arrêté d'apprendre, c'est pour ça qu'il est à présent membre du serveur, et comme a dit un grand homme, n'arrêtez jamais d'apprendre !",
  "Pauline, on a un problème. {user} est là mais je ne peux pas acceuilir sa grandeur de façons convenables..."
]

def load_starboard_settings
  unless File.exist?('Data/dataserver.json')
    File.write('Data/dataserver.json', "{}")
  end
  JSON.parse(File.read('Data/dataserver.json'))
end

class AulbumSetCommand < BaseCommand
  def self.register(bot)
    bot.member_join do |event|
        settings = load_starboard_settings
        server_id_str = event.server.id.to_s
        settings[server_id_str] ||= {}
        settings[server_id_str]['autoban_system'] ||= {
            "active" => false,
            "autoban_enabled" => false,
            "log_channel_id" => nil
        }
        settings[server_id_str]['welcome_system'] ||= {
            "active" => false,
            "welcome_channel_id" => nil
        }

        welcome_settings = settings[server_id_str]['welcome_system']
        if welcome_settings['active']
            target_channel = event.server.text_channels.find { |c| c.id == welcome_settings['welcome_channel_id'] }
            if target_channel
            sleep 5
            mention = "<@#{event.user.id}>"
            welcome_text = WELCOME_MESSAGES.sample.gsub("{user}", mention).gsub("{server}", event.server.name)
            gif = WELCOME_GIFS.sample
            allowed = Discordrb::AllowedMentions.new(users: [event.user.id])
            target_channel.send_message("#{welcome_text}\n#{gif}", false, nil, nil, allowed)
            end
            end
        end
    end
end
